<div class="container">

	<h1 id="userName">{{userName}}</h1>
	<div>
		{{#if imgUrl}}
			<img style="height:150px;border-radius:3px;" src="{{imgUrl}}">
		{{else}}
			<img style="height:150px;border-radius:3px;" src="https://quinary-niume.scdn3.secure.raxcdn.com/pic/profile/default_profile.jpg">
		{{/if}}
	</div>
	<h3>About {{userName}}</h3>
	{{#if distance}}
	<p id="distance"><strong>Distance:</strong> {{distance}} miles</p>
	{{/if}}
	<p>You and {{userName}} have {{musicMatch}} taste in music.</p>
	<p><strong>Bio:</strong> {{bio}}</p>

	{{#if age}}<p><strong>Age:</strong> {{age}}</p>{{/if}}
	{{#if gender}}<p><strong>Gender:</strong> {{gender}}</p>{{/if}} <!-- TODO: CONSIDER MAKING THIS GENDERLESS -->
	<button class="btn btn-large btn-info"id="seeBands">See Bands</button>
	<button style="display:none" class="btn btn-large btn-info"id="hideBands">Hide Bands</button>
	<div id="bands" style="display:none">
		<p><strong>Bands:</strong></p>
			<ul>
				{{#each bands}}
						<!--img class="artistImage" src="{{this.artistImage}}"></img-->
						<span class='image'>
							<img class='bandImg' src="{{this.artistImage}}">
							<div class='name'>{{this.name}}</div>
						</span>
				{{/each}}
			</ul>
	</div>
	<div id="messageBox">
		<input id="messageText" type=text>
	</div>
	<button id="sendMessage" class="btn btn-large">Send Message</button>
	<div id="messageSent" class="alert alert-success">Message Sent!</div>
	<button id="nextProfile" class="btn btn-large">Next Profile</button>
	<button id="cancelMessage" class="btn btn-large">Cancel Message</button>	

</div>

<style>

#cancelMessage,
#messageSent{
	display: none;
}
#messageBox{
	display: none;
	height: 150px;
}
#messageText{
	height: 135px;
	width: 90%;
}
#profileBrowser{
	height:60px;
	background: linear-gradient(-45deg, purple, purple, indigo);
	border-bottom: 1px solid white;
	color: white;
	font-family: helvetica;
	font-size: 20px;
	position: fixed;
	bottom: 0;
	left: 0;
	z-index: 999;
	width: 100%;
}


.bandImg{
	height: 175px;
}
.image{
	position:relative;
	text-align:center;
	float: left;		
}
.name{
	display: none;
	color: black;
    left: 0;
	position:absolute;
	bottom: 80px;
	width: 100%;
	font-weight: bold;
	pointer-events:none;
}
.fade{
	opacity: .2;
}

@media (max-width: 600px) {
  .bandImg {
    height: 80px;
  }
  .name{
	bottom: 30px;
  }
}
</style>

<script>

var messageBox = $("#messageBox");
var cancelMessage = $("#cancelMessage");
var nextProfile = $("#nextProfile");
var sendMessage = $("#sendMessage");
var messageSent = $("#messageSent");
var seeBands = $("#seeBands");
var hideBands = $("#hideBands");

nextProfile.one('click', function(){
	$.ajax({
		method: "GET",
		url: "/next-profile",
		data: name,
		dataType: "text",
		success: function(name){
			console.log(name);
			window.location.href = name;
		}
	});
});

sendMessage.on('click', function(){
	console.log("yep, clicked");
	if(messageBox.is(':visible')){
		//send the message
		var message = $("#messageText").val();
		var reciever = $("#userName").text();
		console.log(message);
		console.log('fixin to send the message for ya');
		$.ajax({
			method: "POST",
			url: "/send-message",
			data: {
			"message" : message,
			"reciever" : reciever
			}
		}).done(function(response){
			console.log(response);
			messageBox.fadeOut();
			sendMessage.hide();
			messageSent.show();
		});
		cancelMessage.hide();
		nextProfile.show();
	}else{
		cancelMessage.show();
		nextProfile.hide();
		messageBox.show();
	}
	
	cancelMessage.on('click', function(){
		messageBox.hide();
		$(this).hide();
		nextProfile.show();
	});
});

seeBands.click(function(){
	$("#bands").show();
	$(this).hide();
	hideBands.show();
});

hideBands.click(function(){
	$("#bands").hide();
	$(this).hide();
	seeBands.show();	
});

$(document).on("mouseenter", "img.bandImg", function(){
	$(this).addClass("fade").siblings().show();
});
$(document).on("mouseleave", "img.bandImg", function(){
	$(this).removeClass("fade").siblings().hide();
});


</script>
